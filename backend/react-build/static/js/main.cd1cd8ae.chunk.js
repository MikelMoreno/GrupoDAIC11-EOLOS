(this["webpackJsonpeolos-frontend"]=this["webpackJsonpeolos-frontend"]||[]).push([[0],{100:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var a=n(2),i=n(0),c=n.n(i),r=n(10),s=n.n(r),o=(n(100),n(19)),l=n(20),d=n(23),j=n(22),u=n(21),b=n(35),h=n(11),p=n(25),O=n(50),x=n(168),m=n(167),f=n(161),v=n(178),g=n(177),y=n(109),C=n(77),S=n.n(C),w=n(163),k=n(164),L=n(165),I=n(166),P=n(84),T=n.n(P),N=n(169),q=n(68),M=n(158),A=n(12),D=240,U=Object(M.a)((function(e){return{root:{display:"flex"},drawer:Object(O.a)({},e.breakpoints.up("sm"),{width:D,flexShrink:0}),appBar:Object(O.a)({},e.breakpoints.up("sm"),{width:"calc(100% - ".concat(D,"px)"),marginLeft:D}),menuButton:Object(O.a)({marginRight:e.spacing(2)},e.breakpoints.up("sm"),{display:"none"}),toolbar:e.mixins.toolbar,drawerPaper:{width:D},content:{flexGrow:1,padding:e.spacing(3)}}}));var E=function(e){var t=e.window,n=U(),i=Object(A.a)(),r=c.a.useState(!1),s=Object(p.a)(r,2),o=s[0],l=s[1],d=function(){l(!o)},j=Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:n.toolbar}),Object(a.jsx)(f.a,{}),Object(a.jsx)(w.a,{children:Object(a.jsx)(b.b,{to:{pathname:"/"},style:{textDecoration:"none"},children:Object(a.jsxs)(k.a,{button:!0,children:[Object(a.jsx)(L.a,{children:Object(a.jsx)(S.a,{})}),Object(a.jsx)(I.a,{primary:"Home"})]},"Home")})}),Object(a.jsx)(f.a,{}),Object(a.jsx)(w.a,{children:Object(a.jsxs)(k.a,{button:!0,onClick:e.onLogout,children:[Object(a.jsx)(L.a,{children:Object(a.jsx)(S.a,{})}),Object(a.jsx)(I.a,{primary:"Log out"})]},"Log out")})]}),u=void 0!==t?function(){return t().document.body}:void 0;return Object(a.jsxs)("div",{className:n.root,children:[Object(a.jsx)(m.a,{}),Object(a.jsx)(x.a,{position:"fixed",className:n.appBar,children:Object(a.jsxs)(N.a,{children:[Object(a.jsx)(y.a,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:d,className:n.menuButton,children:Object(a.jsx)(T.a,{})}),Object(a.jsx)(q.a,{variant:"h6",noWrap:!0,children:"Project Eolos"})]})}),Object(a.jsxs)("nav",{className:n.drawer,"aria-label":"mailbox folders",children:[Object(a.jsx)(g.a,{smUp:!0,implementation:"css",children:Object(a.jsx)(v.a,{container:u,variant:"temporary",anchor:"rtl"===i.direction?"right":"left",open:o,onClose:d,classes:{paper:n.drawerPaper},ModalProps:{keepMounted:!0},children:j})}),Object(a.jsx)(g.a,{xsDown:!0,implementation:"css",children:Object(a.jsx)(v.a,{classes:{paper:n.drawerPaper},variant:"permanent",open:!0,children:j})})]}),Object(a.jsxs)("main",{className:n.content,children:[Object(a.jsx)("div",{className:n.toolbar}),e.appContent]})]})},_=n(170),J=n(108),R=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(q.a,{variant:"h5",children:"Your devices:"}),Object(a.jsx)("br",{}),Object(a.jsx)(_.a,{container:!0,spacing:3,children:this.props.devices.map((function(e){return Object(a.jsx)(_.a,{item:!0,xs:12,sm:6,md:3,children:Object(a.jsx)(b.b,{to:{pathname:"/device/"+e.identifier},style:{textDecoration:"none"},children:Object(a.jsx)(J.a,{style:{padding:"10px"},children:Object(a.jsxs)("div",{style:{textAlign:"center"},children:[Object(a.jsx)(q.a,{variant:"h6",children:e.identifier}),Object(a.jsx)("br",{}),Object(a.jsxs)(q.a,{children:["Room: ",e.room.name]}),Object(a.jsx)("br",{}),Object(a.jsx)(q.a,{children:e.room.description})]})})})},e._id)}))})]})}}]),n}(c.a.Component),H=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(_.a,{container:!0,spacing:3,children:[Object(a.jsx)(_.a,{item:!0,xs:12,children:Object(a.jsxs)("div",{children:[Object(a.jsx)(q.a,{variant:"h5",children:"Welcome back"}),Object(a.jsx)("br",{}),Object(a.jsx)(q.a,{variant:"subtitle1",children:this.props.user.email})]})}),Object(a.jsx)(_.a,{item:!0,xs:12,children:Object(a.jsx)(R,{devices:this.props.user.devices})})]})}}]),n}(c.a.Component),V=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(o.a)(this,n),t.call(this,e)}return Object(l.a)(n,[{key:"render",value:function(){return Object(a.jsx)("p",{children:"Account page"})}}]),n}(c.a.Component),W=n(179),B=n(172),G=n(173),F=n(78),X=n.n(F),Y=n(175);function z(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(Y.a,{disabled:!0,id:"outlined-read-only-input"+e.label,label:e.label,defaultValue:e.text,InputProps:{readOnly:!0},style:{width:"100%"},variant:"outlined"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]})}function K(e){return Object(a.jsxs)(J.a,{style:{padding:"15px"},children:[Object(a.jsx)(q.a,{variant:"h6",children:"Information"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{style:{width:"100%"},children:[Object(a.jsx)(z,{label:"Identifier",text:e.device.identifier}),Object(a.jsx)(z,{label:"Current public URL",text:e.device.public_url})]})]})}var Q=n(171);function Z(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(Y.a,{id:"outlined-input"+e.label,label:e.label,defaultValue:e.text,style:{width:"100%"},variant:"outlined",onChange:function(t){e.setValue(t.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]})}function $(e){var t=Object(i.useState)(e.room?e.room.name:""),n=Object(p.a)(t,2),c=n[0],r=n[1],s=Object(i.useState)(e.room?e.room.description:""),o=Object(p.a)(s,2),l=o[0],d=o[1],j=Object(i.useState)(e.room?e.room.volume:0),u=Object(p.a)(j,2),b=u[0],h=u[1];return Object(a.jsxs)(J.a,{style:{padding:"15px"},children:[Object(a.jsx)(q.a,{variant:"h6",children:"Room"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{style:{width:"100%"},children:[Object(a.jsx)(Z,{label:"Name",text:c,setValue:r}),Object(a.jsx)(Z,{label:"Description",text:l,setValue:d}),Object(a.jsx)(Y.a,{type:"number",defaultValue:b,label:"Room volume",variant:"outlined",style:{width:"100%"},onChange:function(e){return h(e.target.value)}}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{}),Object(a.jsx)(Q.a,{variant:"contained",color:"primary",style:{width:"100%"},onClick:function(){return e.updateRoom(c,l,b)},children:"Update room"})]})]})}var ee=n(55);function te(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(Y.a,{name:e.name,id:"outlined-input"+e.label,label:e.label,defaultValue:e.text,InputProps:{readOnly:!1},style:{width:"100%"},onChange:e.handleInputChange,variant:"outlined"}),Object(a.jsx)("br",{}),Object(a.jsx)("br",{})]})}var ne=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={tem:-1,tes:-1,maxgas:-1,maxhcho:-1,dev_online:!1},a.handleInputChange=a.handleInputChange.bind(Object(d.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(ee.requestGetParams)(this.props.device.identifier,(function(t){if(console.log("resssp"),console.log(t),!t.error)return e.setState({tem:t.TEM,tes:t.TES,maxgas:t.MAXGAS,maxhcho:t.MAXHCHO,dev_online:!0});e.setState({dev_online:!1})}))}},{key:"handleInputChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(O.a)({},n,a))}},{key:"handleSubmit",value:function(){console.log("submit clicked");var e=this.state,t=e.tem,n=e.tes,a=e.maxgas,i=e.maxhcho;Object(ee.requestEditParams)(this.props.device.identifier,n,t,a,i,(function(e){console.log("rewp"),console.log(e),e.success?alert("Operation succeeded"):alert("Operation failed")}))}},{key:"render",value:function(){return this.state.dev_online?Object(a.jsxs)(J.a,{style:{padding:"15px"},children:[Object(a.jsx)(q.a,{variant:"h6",children:"Parameters"}),Object(a.jsx)("br",{}),Object(a.jsxs)("div",{style:{width:"100%"},children:[Object(a.jsx)(te,{name:"tem",label:"Seconds between measurements",text:this.state.tem,handleInputChange:this.handleInputChange,readOnly:!1}),Object(a.jsx)(te,{name:"tes",label:"Seconds between syncs",text:this.state.tes,handleInputChange:this.handleInputChange,readOnly:!1}),Object(a.jsx)(te,{name:"maxgas",label:"Max gas value",text:this.state.maxgas,handleInputChange:this.handleInputChange,readOnly:!1}),Object(a.jsx)(te,{name:"maxhcho",label:"Max HCHO value",text:this.state.maxhcho,handleInputChange:this.handleInputChange,readOnly:!1}),Object(a.jsx)(Q.a,{variant:"contained",color:"primary",style:{width:"100%"},onClick:this.handleSubmit,children:"Update settings"})]})]}):Object(a.jsxs)(J.a,{style:{padding:"15px"},children:[Object(a.jsx)(q.a,{variant:"h6",children:"Parameters"}),Object(a.jsx)("br",{}),Object(a.jsx)(q.a,{variant:"subtitle1",children:"Can't connect to device"})]})}}]),n}(c.a.Component);function ae(e){return Object(a.jsx)("iframe",{src:e.url+"&theme=light",width:"450",height:200*e.heightMultiplier,frameBorder:"0"})}function ie(e){var t=e.device.grafana_panels.map((function(e,t){return Object(a.jsx)(ae,{url:e,heightMultiplier:t>2&&t<5?1.5:1})}));return Object(a.jsx)("div",{children:t})}function ce(e){var t=e.device;return Object(a.jsxs)(_.a,{container:!0,spacing:3,children:[Object(a.jsx)(_.a,{item:!0,xs:12,sm:3,children:Object(a.jsx)(K,{device:t})}),Object(a.jsx)(_.a,{item:!0,xs:12,sm:3,children:Object(a.jsx)($,{room:t.room,updateRoom:function(t,n,a){var i,c,r=e.device;r.room={name:t,description:n,volume:a},i=r,c=e.updateUser,Object(ee.requestEditRoom)(i,(function(e){console.log("response:"),console.log(e),e.error||c(e.user)}))}})}),Object(a.jsx)(_.a,{item:!0,xs:12,sm:3,children:Object(a.jsx)(ne,{device:t})})]})}function re(e){var t=window.location.pathname.split("/")[2],n=Object(i.useState)(!0),c=Object(p.a)(n,2),r=c[0],s=c[1],o=Object(i.useState)(!0),l=Object(p.a)(o,2),d=l[0],j=l[1];if(!e.user)return null;var u=function(e,t){var n=null;return e.devices.forEach((function(e){e.identifier===t&&(n=e)})),n}(e.user,t);return u?Object(a.jsxs)("div",{children:[Object(a.jsxs)(q.a,{variant:"h5",children:["Device ",u.identifier]}),Object(a.jsx)("br",{}),Object(a.jsxs)(W.a,{expanded:r,children:[Object(a.jsx)(B.a,{expandIcon:Object(a.jsx)(X.a,{}),"aria-controls":"panel1a-content",onClick:function(){return s(!r)},id:"panel1a-header",children:Object(a.jsx)(q.a,{variant:"h6",children:"Details"})}),Object(a.jsx)(G.a,{children:Object(a.jsx)(ce,{device:u,updateUser:e.updateUser})})]}),Object(a.jsxs)(W.a,{expanded:d,children:[Object(a.jsx)(B.a,{expandIcon:Object(a.jsx)(X.a,{}),"aria-controls":"panel2a-content",onClick:function(){return j(!d)},id:"panel2a-header",children:Object(a.jsx)(q.a,{variant:"h6",children:"Analytics"})}),Object(a.jsx)(G.a,{children:Object(a.jsx)(ie,{device:u})})]})]}):null}var se=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).getAppContent=a.getAppContent.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"getAppContent",value:function(){var e=this;return Object(a.jsxs)(h.c,{children:[Object(a.jsx)(h.a,{exact:!0,path:"/account",children:Object(a.jsx)(V,{})}),Object(a.jsx)(h.a,{path:"/device/:id",component:function(){return Object(a.jsx)(re,{user:e.props.user,updateUser:e.props.updateUser})}}),Object(a.jsx)(h.a,{path:"/",children:Object(a.jsx)(H,{user:this.props.user})})]})}},{key:"render",value:function(){return Object(a.jsx)(E,{appContent:this.getAppContent(),onLogout:this.props.handleLogout})}}]),n}(c.a.Component),oe=n(180),le=n(85),de=n.n(le),je=n(174),ue=Object(M.a)((function(e){return{paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}}})),be=function(e,t){t(e.target.value)};function he(e){var t=ue(),n=Object(i.useState)(!1),c=Object(p.a)(n,2),r=(c[0],c[1],Object(i.useState)("")),s=Object(p.a)(r,2),o=s[0],l=s[1],d=Object(i.useState)(""),j=Object(p.a)(d,2),u=j[0],b=j[1];return Object(a.jsxs)(je.a,{component:"main",maxWidth:"xs",children:[Object(a.jsx)(m.a,{}),Object(a.jsxs)("div",{className:t.paper,children:[Object(a.jsx)(oe.a,{className:t.avatar,children:Object(a.jsx)(de.a,{})}),Object(a.jsx)(q.a,{component:"h1",variant:"h5",children:"Log in"}),Object(a.jsxs)("form",{className:t.form,noValidate:!0,children:[Object(a.jsx)(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email",name:"email",autoComplete:"email",value:o,onChange:function(e){be(e,l)},autoFocus:!0}),Object(a.jsx)(Y.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Password",type:"password",id:"password",value:u,onChange:function(e){be(e,b)},autoComplete:"current-password"}),Object(a.jsx)(Q.a,{type:"button",fullWidth:!0,variant:"contained",color:"primary",onClick:function(){e.onLogin(o,u)},className:t.submit,children:"Log In"})]})]})]})}var pe=n(56),Oe=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).handleLogin=a.handleLogin.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"handleLogin",value:function(e,t){var n=this;Object(pe.requestLogin)(e,t,(function(e){if(!e.error)return n.props.notifyLogin(e);alert("Invalid credentials")}))}},{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(x.a,{children:Object(a.jsx)("div",{style:{padding:"15px",textAlign:"center"},children:Object(a.jsx)(q.a,{variant:"h4",children:"Project Eolos"})})}),Object(a.jsx)("br",{}),Object(a.jsx)(he,{onLogin:this.handleLogin})]})}}]),n}(c.a.Component),xe=function(e){Object(j.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={user:null},a.handleLogin=a.handleLogin.bind(Object(d.a)(a)),a.updateUser=a.updateUser.bind(Object(d.a)(a)),a.handleLogout=a.handleLogout.bind(Object(d.a)(a)),a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;Object(pe.requestWhoami)((function(t){e.setState({user:t.user})}))}},{key:"handleLogin",value:function(e){this.setState({user:e})}},{key:"updateUser",value:function(e){this.setState({user:e})}},{key:"handleLogout",value:function(){var e=this;Object(pe.requestLogout)((function(t){e.setState({user:null})}))}},{key:"render",value:function(){return Object(a.jsx)(b.a,{children:this.state.user?Object(a.jsx)(h.c,{children:Object(a.jsx)(h.a,{path:"/",children:Object(a.jsx)(se,{user:this.state.user,updateUser:this.updateUser,handleLogout:this.handleLogout})})}):Object(a.jsx)(h.c,{children:Object(a.jsx)(h.a,{path:"/",children:Object(a.jsx)(Oe,{notifyLogin:this.handleLogin})})})})}}]),n}(c.a.Component),me=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,182)).then((function(t){var n=t.getCLS,a=t.getFID,i=t.getFCP,c=t.getLCP,r=t.getTTFB;n(e),a(e),i(e),c(e),r(e)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(xe,{})}),document.getElementById("root")),me()},55:function(e,t,n){var a=n(82).config.cloud_url;e.exports.requestEditRoom=function(e,t){var n={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({device:e})};fetch(a+"/api/device/update/room",n).then((function(e){return e.json()})).then((function(e){t(e)}))},e.exports.requestCreateDevice=function(e,t,n,i,c,r,s){var o={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({device:{identifier:e,public_url:t,room:{name:n,description:i,volume:c},grafana_panels:r}})};fetch(a+"/api/device/create",o).then((function(e){return e.json()})).then((function(e){s(e)}))},e.exports.requestGetDevice=function(e,t){var n={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({identifier:e})};fetch(a+"/api/device/get",n).then((function(e){return e.json()})).then((function(e){t(e)}))},e.exports.requestGetParams=function(e,t){var n={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceID:e})};fetch(a+"/api/device/params/get",n).then((function(e){return e.json()})).then((function(e){t(e)}))},e.exports.requestEditParams=function(e,t,n,i,c,r){var s={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({deviceID:e,TES:t,TEM:n,MAXGAS:i,MAXHCHO:c})};fetch(a+"/api/device/params/edit",s).then((function(e){return e.json()})).then((function(e){r(e)}))}},56:function(e,t,n){var a=n(82).config.cloud_url;e.exports.requestSignup=function(e,t,n,i,c){var r={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n,repassword:i})};fetch(a+"/auth/signup",r).then((function(e){return e.json()})).then((function(e){c(e)}))},e.exports.requestLogin=function(e,t,n){var i={method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})};fetch(a+"/auth/login",i).then((function(e){return e.json()})).then((function(e){n(e)}))},e.exports.requestWhoami=function(e){fetch(a+"/auth/whoami",{credentials:"include"}).then((function(e){return e.json()})).then((function(t){e(t)}))},e.exports.requestLogout=function(e){fetch(a+"/auth/logout",{credentials:"include"}).then((function(e){return e.json()})).then((function(t){e(t)}))}},82:function(e,t){e.exports.config={cloud_url:"http://93.189.90.190:80"}}},[[107,1,2]]]);
//# sourceMappingURL=main.cd1cd8ae.chunk.js.map